/* 
 This file was generated by Dashcode.  
 You may edit this file to customize your widget or web page 
 according to the license.txt file included in the project.
 */

//
// Function: load()
// Called by HTML body element's onload event when the Safari widget is ready to start
//
function load()
{    
    dashcode.setupParts();
    
    // set today's date    
    var todaysDate = document.getElementById("todaysDate");
    todaysDate.innerText = createDateStr(new Date()).toUpperCase();

    setupFilters("headlineList");

    // This message checks for common errors with the RSS feed or setup.
    // The handler will hide the split view and display the error message.
    handleCommonErrors(attributes.dataSource,function(errorMessage){
        var splitLayout = document.getElementById("splitLayout")
        
        if (splitLayout) {
            splitLayout.style.display = 'none';
        }
                       
        showError(errorMessage);
    });
}

function readMoreClicked(event)
{
    var selectedArticle = dashcode.getDataSource('headlineList').selection();
    var link = selectedArticle.valueForKeyPath('link');
    
    // If the link is an object, not a string, then this may be an ATOM feed, grab the actual
    // href from the href attr
    if (typeof(link) == 'object') {
        link = selectedArticle.valueForKeyPath('link.$href');
        // If the link is an array (there is more then one link), just grab the first one
        if (DC.typeOf(link) == 'array'){
            link = link[0];
        }
    }
    
    window.location = link;
}
